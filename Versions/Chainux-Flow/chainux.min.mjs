export const{html,components,onConnect,onRemove,Render,Data,IStore}=(()=>{let t="#!CHNX!#",e=b();HTMLElement.prototype.clear=function(){return this.textContent="",this},HTMLElement.prototype.hide=function(t){return this.style.display=t?"none":this.style.display,this},HTMLElement.prototype.show=function(t){return this.style.display=t?"block":this.style.display,this},Object.defineProperty(HTMLElement.prototype,"text",{set:function(t){this.textContent=t},get:function(){return this.textContent}}),HTMLElement.prototype.addClass=function(t){return this.classList.add(t),this},HTMLElement.prototype.removeClass=function(t){return this.classList.remove(t),this},HTMLElement.prototype.toggleClass=function(t){return this.classList.toggle(t),this},HTMLElement.prototype.setStyle=function(t){for(let e in t){let n=t[e];"function"==typeof n&&(n=n.call(this)),this.style[e]!=n&&(this.style[e]=n)}return this},HTMLElement.prototype.set=function(t,e){for(let n in t.style&&("object"==typeof t.style&&"function"!=typeof t.style?this.setStyle(t.style):this.style="function"==typeof t.style?t.style.call(this):t.style),t)if("callback"!=n&&"style"!=n){if(n.startsWith("on")){this[n]=t[n].bind(this);continue}let o=t[n];if("function"==typeof o){let r=o.call(this,e);this[n]!==r&&(this[n]=r)}else n in this?this[n]!==o&&(this[n]=o):this.getAttribute(n)!==o&&this.setAttribute(n,o)}return t.callback&&("function"==typeof t.callback?t.callback.call(this):console.warn("Set Callback Must Be a Function!")),this};let n=0;function o(t,e){let o=e,i=n++;return l||s(),new Proxy(t,{get:(t,e)=>t[e],set(t,e,n){let l=t[e];if(t[e]!=n){t[e]=n;let s={before:l,current:n,key:e,id:i};r.mountedISElements.forEach((t,e)=>{e.set(t,s)}),o&&o.call(s)}return 1}})}let r={temp:{},elementHooksPair:new WeakMap,elementDataPair:new WeakMap,elementISPair:new WeakMap,mountedISElements:new Map,eMSG:"Component onConnect & onRemove hooks must be a function!"};function i(t){return r.temp.data=t}i.hasData=function(t){return r.elementDataPair.has(t)},i.getData=function(t){if(i.hasData(t))return r.elementDataPair.get(t)};let l;function s(){(l=new MutationObserver(t=>{t.forEach(t=>{"childList"==t.type&&(t.addedNodes.forEach(t=>{t instanceof HTMLElement&&[t,...t.querySelectorAll("*")].forEach(t=>{if(r.elementISPair.has(t)){let e=r.elementISPair.get(t);r.mountedISElements.set(t,e),t.set(e)}c("connect",t)})}),t.removedNodes.forEach(t=>{t instanceof HTMLElement&&[t,...t.querySelectorAll("*")].forEach(t=>{r.mountedISElements.has(t)&&r.mountedISElements.delete(t),c("remove",t)})}))})})).observe(document.body,{childList:!0,subtree:!0})}function a(t,e){"function"==typeof e?r.temp[t]=e:console.warn(r.eMSG),l||s()}function c(t,e){let n=r.elementHooksPair;n.has(e)&&n.get(e)[t]&&n.get(e)[t].call(e,e)}let u=t=>{a("connect",t)},f=t=>{a("remove",t)},h=()=>{r.temp.connect=null,r.temp.remove=null,r.temp.data=null};function m(t,e){h();let n=t.call(e),{remove:o,connect:i,data:l}=r.temp;return(i||o)&&r.elementHooksPair.set(n,{remove:o,connect:i}),l&&r.elementDataPair.set(n,l),h(),n}function p(t){return document.createRange().createContextualFragment(t)}function d(e){let n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),o;for(;o=n.nextNode();)o.textContent.includes(t)&&g(o)}function y(t){let e=t,n=e.split("/>").length-1,o=0;for(;n>o;){let r=e.search("/>")-1,i=0,l="";for(;r-i>=-1;){if("<"==e.charAt(r-i)){let s=(l=l.split("").reverse().join("")).split(" ")[0],a=`<${s} ${l.replace(s,"")||""}></${s}>`;e=e.slice(0,r-i)+a+e.slice(r+3,e.length),o++,r="",i=0,l=""}else l+=e.charAt(r-i);i++}}return e}function g(e){let n=document.createRange(),o=e.textContent,r=0;for(;o.includes(t);){let i=o.indexOf(t,r),l=i+t.length;n.setStart(e,i),n.setEnd(e,l),n.deleteContents();let s=document.createElement("chnx");n.insertNode(s),o=e.textContent,r=i+13}}function b(){let t=new Map;return{get(e){if(t.has(e))return t.get(e);console.warn("Component<"+e+"> is not defined!")},set(e,n){if("string"!=typeof e){console.error("Key must be a string.");return}if("function"!=typeof n){console.error("Value must be a component-function.");return}if(e.includes(" ")){console.error("Component names should not contain spaces.");return}t.set(e.toLowerCase(),n)},map:t}}function C(t){let e={},n=new DocumentFragment;return t.querySelectorAll("[slot]").forEach(t=>{e[t.getAttribute("slot")]=t,t.removeAttribute("slot"),t.remove()}),Array.from(t.childNodes).forEach(t=>{n.appendChild(t)}),{slot:n,slots:e}}function v(t){let n=document.createElement("div");t.replaceWith(n);let o=m(e.get(t.tagName.toLowerCase()),this);if(o instanceof HTMLElement){let r=o.querySelector("slot:not([name])"),i=o.querySelectorAll("slot[name]");r&&r.replaceWith(this.slot),i.length&&i.forEach(t=>{let e=t.getAttribute("name");this.slots[e]&&t.replaceWith(this.slots[e])}),n.replaceWith(o)}else console.error("Component-Function output must be a element!");return o}function A(n,...o){let i,l=r.temp.data,s=[...o];n.forEach((e,n)=>{i+=e,s.length!==n&&(i+=t)}),(i=i.replaceAll("<>","<div>").replaceAll("</>","</div>")).includes("/>")&&(i=y(i));let a=p(i).firstElementChild,c=[],u=!1,f=()=>[a,...a.querySelectorAll("*")];return f().forEach((e,n)=>{e.textContent.includes(t)&&d(e)}),f().forEach(function n(o,i){if(e.map.has(o.tagName.toLowerCase())){let f={};if(0==i&&(u=!0),o.hasAttributes())for(let h of o.attributes)if(o.getAttribute(h.name)==t){let m=s.shift();f[h.name]=m}else f[h.name]=h.value;c.push({target:o,values:f});return}if(s.length){if(o.hasAttributes()){let p=!1,d={};for(let y of Array.from(o.attributes))if(o.getAttribute(y.name)==t){let g=s.shift();if(void 0===g){o.removeAttribute(y.name);continue}if("use"==y.name){o.removeAttribute("use"),g.call(o,{parent:a,data:l});continue}if(y.name.startsWith(":")){"function"==typeof g?(p=!0,d[y.name.slice(1)]=g.bind(o)):o.set({[y.name.slice(1)]:g}),o.removeAttribute(y.name);continue}if("set"==y.name){o.set(g),o.removeAttribute("set");continue}if(y.name.startsWith("on")){"function"==typeof g&&o.addEventListener(y.name.slice(2),()=>g.call(o,{parent:a,data:l})),o.removeAttribute(y.name);continue}if("function"==typeof g){o.setAttribute(y.name,g.call(this));continue}o.setAttribute(y.name,g)}p&&r.elementISPair.set(o,d)}if("CHNX"===o.tagName){let b=s.shift();if(void 0==b){o.remove();return}if(!(b instanceof Object)){o.replaceWith(document.createTextNode(b));return}if("function"==typeof b){(b=b.call({parent:a,data:l}))instanceof Node&&o.replaceWith(b),b instanceof Object||o.replaceWith(new Text(b));return}if(b instanceof Node){o.replaceWith(b);return}}}}),c.forEach(t=>{let e=v.call({props:t.values,...C(t.target),parent:a,data:l},t.target);u&&(a=e)}),a}return A.plain=function(t){return p(t)},HTMLElement.prototype.inner=function(t){this.clear(),this.appendChild(t)},{html:A,components:e,onConnect:u,onRemove:f,Render:m,Data:i,IStore:o}})();